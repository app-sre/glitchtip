FROM quay.io/app-sre/qontract-reconcile:4ec79143580995ef9fc245d973611b5e0a41bab9
ARG CONTAINER_UID=1000
RUN useradd --uid ${CONTAINER_UID} reconcile

WORKDIR /acceptance

COPY requirements-acceptance.txt ./
RUN python3 -m pip install install --no-cache-dir -r requirements-acceptance.txt

COPY acceptance/ ./
RUN chown -R reconcile .

USER reconcile
CMD ["pytest", "-v", "."]
